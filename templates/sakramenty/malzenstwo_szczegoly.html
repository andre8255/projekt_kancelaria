{% extends "base_panel.html" %}
{% block content %}

<div class="d-flex justify-content-between align-items-start mb-3">
  <h1 class="h5 mb-0">Ma≈Ç≈ºe≈Ñstwo</h1>

  <div class="d-flex flex-wrap gap-2 ms-auto">
    <a href="{% url 'malzenstwo_pdf' malzenstwo.pk %}" target="_blank" class="btn btn-outline-secondary btn-sm">
      üìÑ Pobierz PDF (Za≈õwiadczenie)
    </a>
    <a href="{% url 'malzenstwo_druk' malzenstwo.pk %}" class="btn btn-outline-secondary btn-sm">
      üñ®Ô∏èDrukuj</a>
    <a href="{% url 'malzenstwo_edytuj' malzenstwo.pk %}" class="btn btn-outline-secondary btn-sm">‚úèÔ∏è Edytuj</a>
    <a href="{% url 'malzenstwo_usun' malzenstwo.pk %}" class="btn btn-outline-danger btn-sm">üóëÔ∏è Usu≈Ñ</a>
    <a href="{% url 'malzenstwo_lista' %}" class="btn btn-outline-secondary btn-sm">‚¨Ö Powr√≥t</a>
  </div>
</div>

<div class="card shadow-sm border-0">
  <div class="card-body">
    
    {# --- DANE OG√ìLNE AKTU --- #}
    <div class="row mb-4">
      <div class="col-12">
        <h6 class="fw-bold text-muted text-uppercase small mb-3">Dane aktu</h6>
        <p class="mb-1">
            <strong>Rok / Nr aktu:</strong> {{ malzenstwo.rok }}/{{ malzenstwo.akt_nr }}
        </p>
        <p class="mb-1">
            <strong>Data ≈õlubu:</strong> {{ malzenstwo.data_slubu|default:"‚Äî" }}
        </p>
        <p class="mb-1">
            <strong>Parafia ≈õlubu:</strong>
            {% if malzenstwo.parafia %}
                {{ malzenstwo.parafia.nazwa }} 
                {% if malzenstwo.parafia.miejscowosc %}({{ malzenstwo.parafia.miejscowosc }}){% endif %}
            {% elif malzenstwo.parafia_opis_reczny %}
                {{ malzenstwo.parafia_opis_reczny }}
            {% else %}
                <span class="text-muted">‚Äî</span>
            {% endif %}
        </p>
        <p class="mb-1">
            <strong>≈öwiadek urzƒôdowy / asystujƒÖcy:</strong>
            {% if malzenstwo.swiadek_urzedowy %}
                {{ malzenstwo.swiadek_urzedowy }}
            {% elif malzenstwo.swiadek_urzedowy_opis_reczny %}
                {{ malzenstwo.swiadek_urzedowy_opis_reczny }}
            {% else %}
                <span class="text-muted">‚Äî</span>
            {% endif %}
        </p>
      </div>
    </div>

    {# --- KARTY MA≈Å≈ªONK√ìW OBOK SIEBIE --- #}
    <div class="row g-4 mb-4">
        
      {# KARTA Mƒò≈ªA #}
      <div class="col-md-6">
        <div class="card h-100 border-primary-subtle">
          <div class="card-header bg-primary-subtle text-primary border-primary-subtle fw-semibold">
            Ma≈Ç≈ºonek A (MƒÖ≈º)
          </div>
          <div class="card-body small">
            <h5 class="card-title mb-1">
                {{ malzenstwo.malzonek_a.imie_pierwsze }} {{ malzenstwo.malzonek_a.nazwisko }}
            </h5>
            {% if malzenstwo.malzonek_a.nazwisko_rodowe and malzenstwo.malzonek_a.nazwisko != malzenstwo.malzonek_a.nazwisko_rodowe %}
                <div class="text-muted mb-2">z domu: {{ malzenstwo.malzonek_a.nazwisko_rodowe }}</div>
            {% endif %}
            
            <hr>
            <p class="mb-1"><strong>Urodzony:</strong> {{ malzenstwo.malzonek_a.data_urodzenia|default:"‚Äî" }}</p>
            <p class="mb-1"><strong>Miejsce:</strong> {{ malzenstwo.malzonek_a.miejsce_urodzenia|default:"‚Äî" }}</p>
            <p class="mb-0"><strong>≈öwiadek:</strong> {{ malzenstwo.swiadek_a|default:"‚Äî" }}</p>
          </div>
        </div>
      </div>

      {# KARTA ≈ªONY #}
      <div class="col-md-6">
        <div class="card h-100 border-danger-subtle">
          <div class="card-header bg-danger-subtle text-danger border-danger-subtle fw-semibold">
            Ma≈Ç≈ºonek B (≈ªona)
          </div>
          <div class="card-body small">
            <h5 class="card-title mb-1">
                {{ malzenstwo.malzonek_b.imie_pierwsze }} {{ malzenstwo.malzonek_b.nazwisko }}
            </h5>
            
            {# LOGIKA DLA DRUGIEGO MA≈Å≈ªE≈ÉSTWA #}
            {% if malzenstwo.malzonek_b.nazwisko_rodowe and malzenstwo.malzonek_b.nazwisko != malzenstwo.malzonek_b.nazwisko_rodowe %}
                <div class="text-muted mb-2">
                    z domu: <strong>{{ malzenstwo.malzonek_b.nazwisko_rodowe }}</strong>
                </div>
            {% endif %}

            <hr>
            <p class="mb-1"><strong>Urodzona:</strong> {{ malzenstwo.malzonek_b.data_urodzenia|default:"‚Äî" }}</p>
            <p class="mb-1"><strong>Miejsce:</strong> {{ malzenstwo.malzonek_b.miejsce_urodzenia|default:"‚Äî" }}</p>
            <p class="mb-0"><strong>≈öwiadek:</strong> {{ malzenstwo.swiadek_b|default:"‚Äî" }}</p>
          </div>
        </div>
      </div>

    </div> {# /row ma≈Ç≈ºonk√≥w #}

    {# --- UWAGI I ZA≈ÅƒÑCZNIKI --- #}
    <div class="row">
        <div class="col-12">
            <div class="mb-3 p-3 bg-light rounded border">
                <strong>Uwagi wewnƒôtrzne: </strong><br>
                {{ malzenstwo.uwagi_wew|default:"(brak uwag)" }}
            </div>

            <div class="card shadow-sm border-0">
                <div class="card-header fw-semibold">
                  Za≈ÇƒÖczniki
                </div>
                <div class="card-body small">
                  {% if malzenstwo.skan_aktu %}
                    <a href="{{ malzenstwo.skan_aktu.url }}" target="_blank" class="btn btn-outline-primary btn-sm">
                      üìÑ Zobacz skan aktu/protoko≈Çu
                    </a>
                  {% else %}
                    <span class="text-muted">Brak za≈ÇƒÖczonego skanu.</span>
                  {% endif %}
                </div>
            </div>
        </div>
    </div>

  </div>
</div>

{% endblock %}