{% extends "base_panel.html" %}

{% block content %}

<div class="d-flex justify-content-between align-items-start flex-wrap gap-3 mb-4">
  <h1 class="h5 mb-0">Chrzest</h1>

  <div class="d-flex flex-wrap gap-2">
    <a href="{% url 'chrzest_edytuj' chrzest.pk %}" class="btn btn-outline-secondary btn-sm">
      Edytuj
    </a>
    <a href="{% url 'chrzest_usun' chrzest.pk %}" class="btn btn-outline-danger btn-sm">
      Usuń
    </a>
    <a href="{% url 'chrzest_lista' %}" class="btn btn-outline-secondary btn-sm">
      Powrót
    </a>
  </div>
</div>


<div class="row g-4">

  <div class="col-md-6">
    <div class="card shadow-sm border-0 h-100">
      <div class="card-header fw-semibold">
        Dane aktu chrztu
      </div>
      <div class="card-body small">
        <p class="mb-2">
          <span class="text-muted d-block">Rok / nr aktu</span>
          <strong>{{ chrzest.rok }}/{{ chrzest.akt_nr }}</strong>
        </p>

        <p class="mb-2">
          <span class="text-muted d-block">Data chrztu</span>
          {% if chrzest.data_chrztu %}
            <strong>{{ chrzest.data_chrztu }}</strong>
          {% elif chrzest.rok_chrztu %}
            <strong>rok {{ chrzest.rok_chrztu }}</strong>
          {% else %}
            <span class="text-muted">—</span>
          {% endif %}
        </p>

        <p class="mb-2">
          <span class="text-muted d-block">Miejsce chrztu</span>
          {% if chrzest.miejsce_chrztu %}
            <strong>{{ chrzest.miejsce_chrztu }}</strong>
          {% else %}
            <span class="text-muted">—</span>
          {% endif %}
        </p>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card shadow-sm border-0 h-100">
      <div class="card-header fw-semibold">
        Ochrzczony / ochrzczona
      </div>
      <div class="card-body small">

        <p class="mb-2">
          <span class="text-muted d-block">Imię i nazwisko</span>
          <strong>
            {{ chrzest.ochrzczony.nazwisko }} {{ chrzest.ochrzczony.imie_pierwsze }}
          </strong>
        </p>

        <p class="mb-2">
          <span class="text-muted d-block">Data urodzenia</span>
          {% if chrzest.data_urodzenia %}
            <strong>{{ chrzest.data_urodzenia }}</strong>
          {% elif chrzest.rok_urodzenia %}
            <strong>rok {{ chrzest.rok_urodzenia }}</strong>
          {% else %}
            <span class="text-muted">—</span>
          {% endif %}
        </p>

        <p class="mb-2">
          <span class="text-muted d-block">Miejsce urodzenia</span>
          {% if chrzest.miejsce_urodzenia %}
            <strong>{{ chrzest.miejsce_urodzenia }}</strong>
          {% else %}
            <span class="text-muted">—</span>
          {% endif %}
        </p>

      </div>
    </div>
  </div>


  <div class="col-md-12">
    <div class="card shadow-sm border-0">
      <div class="card-header fw-semibold">
        Rodzice
      </div>
      <div class="card-body small row g-4">

        <div class="col-md-6">
          <div class="border rounded p-3 h-100">
            <div class="text-muted small fw-semibold text-uppercase mb-2">
              Ojciec
            </div>

            <p class="mb-2">
              <span class="text-muted d-block">Imię i nazwisko</span>
              {% if chrzest.ojciec %}
                <strong>{{ chrzest.ojciec }}</strong>
              {% else %}
                <span class="text-muted">—</span>
              {% endif %}
            </p>

            <p class="mb-0">
              <span class="text-muted d-block">Wyznanie</span>
              {% if chrzest.ojciec_wyznanie %}
                <strong>{{ chrzest.ojciec_wyznanie }}</strong>
              {% else %}
                <span class="text-muted">—</span>
              {% endif %}
            </p>
          </div>
        </div>

        <div class="col-md-6">
          <div class="border rounded p-3 h-100">
            <div class="text-muted small fw-semibold text-uppercase mb-2">
              Matka
            </div>

            <p class="mb-2">
              <span class="text-muted d-block">Imię i nazwisko</span>
              {% if chrzest.matka %}
                <strong>{{ chrzest.matka }}</strong>
              {% else %}
                <span class="text-muted">—</span>
              {% endif %}
            </p>

            <p class="mb-2">
              <span class="text-muted d-block">Nazwisko rodowe</span>
              {% if chrzest.nazwisko_matki_rodowe %}
                <strong>{{ chrzest.nazwisko_matki_rodowe }}</strong>
              {% else %}
                <span class="text-muted">—</span>
              {% endif %}
            </p>

            <p class="mb-0">
              <span class="text-muted d-block">Wyznanie</span>
              {% if chrzest.matka_wyznanie %}
                <strong>{{ chrzest.matka_wyznanie }}</strong>
              {% else %}
                <span class="text-muted">—</span>
              {% endif %}
            </p>
          </div>
        </div>

      </div>
    </div>
  </div>


  <div class="col-md-12">
    <div class="card shadow-sm border-0">
      <div class="card-header fw-semibold">
        Uwagi kancelaryjne
      </div>
      <div class="card-body small">
        {% if chrzest.uwagi_wew %}
          <p class="mb-0" style="white-space:pre-line;">{{ chrzest.uwagi_wew }}</p>
        {% else %}
          <p class="text-muted mb-0">Brak uwag.</p>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-md-12">
    <div class="card shadow-sm border-0">
      <div class="card-header fw-semibold">
        Drukuj świadectwo
      </div>
      <div class="card-body">
        <p class="card-text small text-muted">
          Wybierz adnotację, która ma się pojawić w punkcie 7. (Uwagi) na wydruku.
        </p>

        <div class="mb-3">
          <label for="print_purpose" class="form-label small">Cel wydruku:</label>
          <select id="print_purpose" class="form-select form-select-sm" style="max-width: 350px;">
            <option value="" selected>(Brak adnotacji)</option>
            <option value="Do ślubu">Do ślubu</option>
            <option value="Do bierzmowania">Do bierzmowania</option>
            <option value="Święcenia kapłańskie">Święcenia kapłańskie</option>
            <option value="Wystąpienie z kościoła">Wystąpienie z kościoła</option>
            <option value="uwagi_wew">(Pokaż uwagi wewnętrzne z księgi)</option>
          </select>
        </div>

        <button id="print_button" class="btn btn-primary btn-sm">
          Generuj wydruk
        </button>
      </div>
    </div>
  </div>
  </div> <script>
document.getElementById('print_button').addEventListener('click', function() {
  // 1. Pobierz wybraną wartość z listy
  var cel = document.getElementById('print_purpose').value;

  // 2. Ustal bazowy adres URL (taki sam jak w starym przycisku "Drukuj")
  var baseUrl = "{% url 'chrzest_druk' chrzest.pk %}";
  var finalUrl = baseUrl;

  // 3. Dodaj wartość jako parametr URL
  if (cel === 'uwagi_wew') {
    finalUrl += '?cel=uwagi_wew';
  } else if (cel) {
    finalUrl += '?cel=' + encodeURIComponent(cel);
  }
  
  // 4. Otwórz stronę wydruku w nowej karcie
  window.open(finalUrl, '_blank');
});
</script>


{% endblock %}